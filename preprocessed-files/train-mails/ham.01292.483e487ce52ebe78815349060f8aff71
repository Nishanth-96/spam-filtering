e-matt gmbh www.e-matters.d -= secur advisori =- advisori : remot compromise/do vulner in php releas date : number/number/numb last modifi : number/number/numb author : stefan esser emailaddr applic : php number.number.numb , number.number.numb sever : a vulner within the multipart/form-data handler could allow remot compromis of the web server . risk : critic vendor statu : patch releas . refer : httpaddr overview : we have discov a seriou vulner within the default version of php . depend on the processor architectur it may be possibl for a remot attack to either crash or compromis the web server . detail : php number.number.numb introduc a complet rewritten multipart/form-data post handler . while i wa work on the code in my role as php develop i found a bug within the way the mime header are process . a malform post request can trigger an error condit , that is not correctli handl . due to thi bug it could happen that an uninit- ialis struct get append to the link list of mime header . when the list get clean or destroy php tri to free the pointer that are expect in the struct . becaus of the lack of initialis those pointer contain stuff that wa left on the stack by previou function call . on the ianumb architectur ( aka . xnumber ) it is not possibl to control what will end up in the uninitialis struct becaus of the stack layout . all possibl code path leav illeg address within the struct and php will crash when it tri to free them . unfortun the situat is absolut differ if you look on a solari sparc instal . here it is possibl for an attack to free chunk of memori that are full under hi control . thi is most probabl the case for sever more non ianumb architectur . pleas note that exploit is not onli limit to system that are run malloc ( ) /free ( ) implement that are known to be vulner to control structur overwrit . thi is becaus the intern php memori manag implement it own link list system that can be use to overwrit nearli arbitrari memori address . proof of concept : e-matt is not go to releas the exploit for thi vulner to the public . vendor respons : numberth juli number - an updat version of php which fix thi vulner wa releas and can be download at : httpaddr the vendor announc is avail at : httpaddr recommend : if you are run php number.number.x you should upgrad as soon as possibl , especi if your server run on a non ianumb cpu . if you can not upgrad for whatev reason the onli way to workaround thi , is to disabl all kind of post request on your server . gpg-key : httpaddr pub numberd/numberenumberaadnumb number-number-numb e-matt gmbh - securityteam key fingerprint = numberdd numberc fabnumb numbera enumberab caeb numberfnumb number numberenumb aadnumb copyright number stefan esser . all right reserv .